<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Expense Tracker</title>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary: #4f46e5;
            --primary-hover: #4338ca;
            --bg-color: #f3f4f6;
            --card-bg: #ffffff;
            --text-main: #111827;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --danger: #ef4444;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 12px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.5;
            padding: 2rem;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .header {
            grid-column: 1 / -1;
            margin-bottom: 1rem;
            text-align: center;
        }

        h1 {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 0.5rem;
        }

        p.subtitle {
            color: var(--text-secondary);
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 2rem;
            height: fit-content;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-main);
        }

        input, select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        button.btn-primary {
            width: 100%;
            background-color: var(--primary);
            color: white;
            padding: 0.875rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        button.btn-primary:hover {
            background-color: var(--primary-hover);
        }

        .total-card {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #4f46e5 0%, #818cf8 100%);
            color: white;
            text-align: center;
            padding: 1.5rem;
            border-radius: var(--radius);
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
        }
        
        .total-card h2 {
            font-size: 1.5rem;
            font-weight: 500;
        }
        
        .total-card span {
            font-size: 2.5rem;
            font-weight: 700;
        }

        .chart-container {
            position: relative;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .transactions-list {
            margin-top: 1.5rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.1s;
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-info h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-main);
        }

        .transaction-info small {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 1.125rem;
            margin-right: 1rem;
        }

        .delete-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .delete-btn:hover {
            color: var(--danger);
            background-color: #fee2e2;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            body {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Expense Tracker</h1>
        <p class="subtitle">Keep track of your spending easily</p>
    </div>

    <!-- Total Balance Section -->
    <div class="total-card">
        <h2>Total Balance:</h2>
        <span id="total-amount">$0.00</span>
    </div>

    <!-- Left Column: Add Expense -->
    <div class="card">
        <h3 style="margin-bottom: 1.5rem; font-weight: 600;">Add New Transaction</h3>
        <form id="expense-form">
            <div class="form-group">
                <label for="description">Description</label>
                <input type="text" id="description" placeholder="e.g. Weekly Groceries" required>
            </div>
            
            <div class="form-group">
                <label for="amount">Amount ($)</label>
                <input type="number" id="amount" placeholder="0.00" step="0.01" min="0.01" required>
            </div>

            <div class="form-group">
                <label for="category">Category</label>
                <select id="category" required>
                    <option value="Food">Food & Dining</option>
                    <option value="Transport">Transportation</option>
                    <option value="Entertainment">Entertainment</option>
                    <option value="Housing">Housing & Utilities</option>
                    <option value="Shopping">Shopping</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <button type="submit" class="btn-primary">Add Transaction</button>
        </form>
    </div>

    <!-- Right Column: Chart & List -->
    <div class="card">
        <h3 style="margin-bottom: 1.5rem; font-weight: 600;">Spending Overview</h3>
        <div class="chart-container">
            <canvas id="expenseChart"></canvas>
        </div>
        
        <h3 style="margin-top: 2rem; margin-bottom: 1rem; font-weight: 600;">Recent Transactions</h3>
        <div class="transactions-list" id="transaction-list">
            <!-- Transactions will appear here -->
        </div>
    </div>
</div>

<script>
    // State
    const STORAGE_KEY = 'expense_tracker_data_v1';
    let transactions = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    let chartInstance = null;

    // DOM Elements
    const form = document.getElementById('expense-form');
    const list = document.getElementById('transaction-list');
    const totalDisplay = document.getElementById('total-amount');
    const ctx = document.getElementById('expenseChart').getContext('2d');

    // Chart Colors
    const categoryColors = {
        'Food': '#10B981',        // Emerald
        'Transport': '#F59E0B',   // Amber
        'Entertainment': '#8B5CF6', // Violet
        'Housing': '#3B82F6',     // Blue
        'Shopping': '#EC4899',    // Pink
        'Other': '#6B7280'        // Gray
    };

    // Initialize
    function init() {
        render();
        initChart();
    }

    // Add Transaction
    form.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const description = document.getElementById('description').value;
        const amount = parseFloat(document.getElementById('amount').value);
        const category = document.getElementById('category').value;

        const transaction = {
            id: generateID(),
            description,
            amount,
            category,
            date: new Date().toLocaleDateString()
        };

        transactions.push(transaction);
        saveData();
        render();
        form.reset();
    });

    // Delete Transaction
    function deleteTransaction(id) {
        transactions = transactions.filter(t => t.id !== id);
        saveData();
        render();
    }

    // Generate ID
    function generateID() {
        return Math.floor(Math.random() * 1000000);
    }

    // Save to LocalStorage
    function saveData() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(transactions));
    }

    // Render UI (List & Total) and Update Chart
    function render() {
        // Clear list
        list.innerHTML = '';

        // Calculate total
        const total = transactions.reduce((acc, t) => acc + t.amount, 0);
        totalDisplay.innerText = `$${total.toFixed(2)}`;

        // Render list items
        if (transactions.length === 0) {
            list.innerHTML = '<p style="text-align:center; color: var(--text-secondary); padding: 1rem;">No transactions yet.</p>';
        } else {
            // Sort by newness (roughly, since we just push) - actually let's just reverse for display
            transactions.slice().reverse().forEach(t => {
                const item = document.createElement('div');
                item.className = 'transaction-item';
                item.innerHTML = `
                    <div class="transaction-info">
                        <h4>${t.description}</h4>
                        <small>${t.category} â€¢ ${t.date}</small>
                    </div>
                    <div style="display:flex; align-items:center;">
                        <span class="transaction-amount">-$${t.amount.toFixed(2)}</span>
                        <button class="delete-btn" onclick="deleteTransaction(${t.id})" title="Delete">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                        </button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        updateChart();
    }

    // Initialize Chart
    function initChart() {
        chartInstance = new Chart(ctx, {
            type: 'doughnut',
            data: getChartData(),
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: {
                                family: "'Inter', sans-serif"
                            }
                        }
                    }
                }
            }
        });
    }

    // Update Chart Data
    function updateChart() {
        if (!chartInstance) return;
        const data = getChartData();
        chartInstance.data = data;
        chartInstance.update();
    }

    // Helper to aggregate data for chart
    function getChartData() {
        const categories = {};
        
        // Initialize aggregate map
        const allCategories = ['Food', 'Transport', 'Entertainment', 'Housing', 'Shopping', 'Other'];
        allCategories.forEach(c => categories[c] = 0);

        // Sum up amounts
        transactions.forEach(t => {
            if (categories[t.category] !== undefined) {
                categories[t.category] += t.amount;
            } else {
                categories['Other'] += t.amount;
            }
        });

        // Filter out zero values for cleaner chart (optional, but keeping all keys for stable colors is usually better for doughnuts unless dynamic)
        // Let's just map the fixed categories to their data
        
        return {
            labels: allCategories,
            datasets: [{
                data: allCategories.map(c => categories[c]),
                backgroundColor: allCategories.map(c => categoryColors[c]),
                borderWidth: 0,
                hoverOffset: 4
            }]
        };
    }

    init();
</script>

</body>
</html>
